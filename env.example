# =============================================================================
# OSCI Platform - Environment Configuration
# =============================================================================
# Copy this file to .env and update the values before running docker compose.
# IMPORTANT: Change ALL passwords before deploying to production!
# =============================================================================

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
DB_PASSWORD=changeme_strong_password_here
DB_NAME=osci
DB_USER=osci

# -----------------------------------------------------------------------------
# Keycloak (Identity Provider)
# -----------------------------------------------------------------------------
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=changeme_admin_password
KEYCLOAK_DB_NAME=keycloak
# Admin du realm "osci" (utilisateurs applicatifs, pas le master)
KEYCLOAK_REALM_ADMIN_USER=osci-admin
# Email de l'admin realm (identifiant de connexion sur l'app ; si vide, déduit de USER ou username@localhost)
KEYCLOAK_REALM_ADMIN_EMAIL=admin@example.com
# Mot de passe : doit respecter la politique du realm (12+ car., 1 maj., 1 min., 1 chiffre, 1 spécial)
KEYCLOAK_REALM_ADMIN_PASSWORD=Osc1-Admin-Pwd!

# -----------------------------------------------------------------------------
# MinIO (Evidence Storage - S3-compatible)
# -----------------------------------------------------------------------------
MINIO_ROOT_USER=osci-minio
MINIO_ROOT_PASSWORD=changeme_minio_password

# -----------------------------------------------------------------------------
# API (NestJS Backend)
# -----------------------------------------------------------------------------
API_PORT=3000
KEYCLOAK_ISSUER=http://localhost/auth/realms/osci
KEYCLOAK_ISSUER_EXTERNAL=http://localhost/auth/realms/osci
# Deprecated (kept for backward compatibility)
API_JWT_ISSUER=http://localhost/auth/realms/osci
API_CORS_ORIGIN=http://localhost
# Mettre à 1 lorsque l'API est derrière un reverse proxy (ex. Nginx) pour que l'IP client et le rate limiting utilisent X-Forwarded-For / X-Real-IP.
TRUST_PROXY=0
EXPOSE_ERROR_DETAILS=false
# JWT secrets for local (email/password) authentication
API_JWT_SECRET=changeme_jwt_secret_min_32_chars_long
API_JWT_REFRESH_SECRET=changeme_jwt_refresh_secret_min_32_chars

# -----------------------------------------------------------------------------
# OPA (Open Policy Agent)
# -----------------------------------------------------------------------------
OPA_URL=http://opa:8181

# -----------------------------------------------------------------------------
# Frontend (Angular) - URLs as seen from the browser
# -----------------------------------------------------------------------------
KEYCLOAK_URL=http://localhost/auth
KEYCLOAK_REALM=osci
KEYCLOAK_CLIENT_ID=osci-web
# Public URL(s) of the web app (comma-separated). Used to auto-configure Keycloak redirect URIs / web origins.
WEB_APP_URL=http://localhost
# Optional overrides (comma-separated lists) for Keycloak client settings
# KEYCLOAK_WEB_REDIRECT_URIS=http://localhost/*
# KEYCLOAK_WEB_ORIGINS=http://localhost
# Use /api for nginx proxy (recommended) or http://localhost:3000 for direct access
API_URL=/api


# -----------------------------------------------------------------------------
# Community Referentiels (GitHub)
# -----------------------------------------------------------------------------
GITHUB_REFERENTIEL_REPO=zlorgoncho1/osci-referentiel
